from math import *
from random import *

N = 0x665166804CD78E8197073F65F58BCA14E019982245FCC7CAD74535E948A4E0258B2E919BF3720968A00E5240C5E1D6B8831D8FEC300D969FCCEC6CCE11DDE826D3FBE0837194F2DC64194C78379440671563C6C75267F0286D779E6D91D3E9037C642A860A894D8C45B7ED564D341501CEDF260D3019234F2964CCC6C56B6DE8A4F66667E9672A03F6C29D95100CDF5CB363D66F2131823A953621680300AB3A2EB51C12999B6D4249DDE499055584925399F3A8C7A4A5A21F095878E80BBC772F785D2CBF70A87C6B854EB566E1E1BEB7D4AC6EB46023B3DC7FDF34529A40F5FC5797F9C15C54ED4CB018C072168E9C30CA3602E00EA4047D2E5686C6EB37B9
e = 0x2C998E57BC651FE4807443DBB3E794711CA22B473D7792A64B7A326538DC528A17C79C72E425BF29937E47B2D6F6330EE5C13BFD8564B50E49132D47BEFD0EE2E85F4BFE2C9452D62EF838D487C099B3D7C80F14E362B3D97CA4774F1E4E851D38A4A834B077DED3D40CD20DDC45D57581BEAA7B4D299DA9DEC8A1F361C808637238FA368E07C7D08F5654C7B2F8A90D47857E9B9C0A81A46769F6307D5A4442707AFB017959D9A681FA1DC8D97565E55F02DF34B04A3D0A0BF98B7798D7084DB4B3F6696FA139F83ADA3DC70D0B4C57BF49F530DEC938096071F9C4498FDEF9641DFBFE516C985B27D1748CC6CE1A4BEB1381FB165A3D14F61032E0F76F095D
c = 0x503D5DD3BF3D76918B868C0789C81B4A384184DDADEF81142EABDCB78656632E54C9CB22AC2C41178607AA41ADEBDF89CD24EC1876365994F54F2B8FC492636B59382EB5094C46B5818CF8D9B42AED7E8051D7CA1537202D20EF945876E94F502E048AD71C7AD89200341F8071DC73C2CC1C7688494CAD0110FCA4854EE6A1BA999005A650062A5D55063693E8B018B08C4591946A3FC961DAE2BA0C046F0848FBE5206D56767AAE8812D55EE9DECC1587CF5905887846CD3ECC6FC069E40D36B29EE48229C0C79ECEAB9A95B11D15421B8585A2576A63B9F09C56A4CA1729680410DA237AC5B05850604E2AF1F4EDE9CF3928CBB3193A159E64482928B585AC

s = floor(sqrt(N))
M = Matrix([[e, s], [N, 0]])

Mred = M.LLL()
D = [abs(Mred[i, 1]) // s for i in [0, 1]]

for d in D:
    t = randint(2, N - 2)
    tt = pow(t, e, N)
    if tt ^ d != t:
        continue
    flag = int(pow(c, d, N))
    flag = flag.to_bytes((flag.bit_length() + 7) // 8, "big")
    print(f"FLAG: {flag.decode()}")
