from Crypto.Util.number import long_to_bytes as ltb
from gmpy2 import mpz, iroot
from pwn import log

N = 102346477809188164149666237875831487276093753138581452189150581288274762371458335130208782251999067431416740623801548745068435494069196452555130488551392351521104832433338347876647247145940791496418976816678614449219476252610877509106424219285651012126290668046420434492850711642394317803367090778362049205437
C = 4458558515804625757984145622008292910146092770232527464448604606202639682157127059968851563875246010604577447368616002300477986613082254856311395681221546841526780960776842385163089662821
E = 3

def init():
    return mpz(C), mpz(E)

def attack(C, E):
    root, found = iroot(C, E)
    if found:
        log.info('Successfully found exponent')
        log.info(root)
        log.info('Converting data')
        log.success(ltb(root).decode())
    else: log.failure('Cant find exponent')

if __name__ == '__main__':
    log.info('Loading values')
    C, E = init()
    log.info('Starting attack')
    attack(C, E)
